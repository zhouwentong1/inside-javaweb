<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Custom ValidateBox Tooltip - jQuery EasyUI Demo</title>
    <link rel="stylesheet" type="text/css" href="themes/default/easyui.css">
    <link rel="stylesheet" type="text/css" href="themes/icon.css">
    <link rel="stylesheet" type="text/css" href="demo.css">
    <script type="text/javascript" src="jquery-3.1.0.min.js"></script>
    <script type="text/javascript" src="jquery.easyui.min.js"></script>
</head>
<script type="text/javascript">
    $(function () {
        var tabIndex = 0;
//        var valid = $('#ff1').form('validate');
//        demo($('#tt'),0);
        $('#coo').combobox({
            onChange:function(record){
                var peo = $('#coo').combobox('getValue');
                if(peo =='aa') {
                    $('#tt').tabs('disableTab',3);
                } else {
                    $('#tt').tabs('enableTab',3);
                }
            }
        });
        $('#tt').tabs({
            border: false,
            onSelect: function (title, index) {
                $('#tt').tab('setTitle','123213');
                setTitle($('#tt'), {'which':0,'title':'newnewnew'});
                changeTab(tabIndex,index);
            }
        });
        function demo(temp,myIndex) {
            temp.tabs({
                border: false,
                // 这个 title 是跳转的目的地的 title
                onSelect: function (title, index) {
                    changeTab(tabIndex,index)
                }
            });
        }

        function setTitle(target, param) {
            debugger;
            if (!param || !(param.which || $.isNumeric(param.which)) || !param.title) { return; }
            var t = $(target), tab = t.tabs("getTab", param.which);
            tab.panel("setTitle", param.title);
        }

        function getSelectedTitle(target) {
            var t = $(target), tabOpts = t.tabs("getSelectedOption"), title = tabOpts.title;
            return title;
        };
//        var _setTitle = $.fn.panel.methods.setTitle;
//        function setTitle(target, title) {
//            debugger;
//            var t = $(target);
//            if (!inTabs(target)) { return _setTitle.call(t, t, title); }
//            if (!title) { return; }
//            var opts = t.panel("options"), header = t.panel("header");
//            opts.title = title;
//            header.find(">a.tabs-inner>span.tabs-title").text(title);
//        };
//
//        var inTabs = function (target) {
//            var t = $(target), panel = t.panel("panel"), panels = panel.parent(), container = panels.parent();
//            return panels.hasClass("tabs-panels") && container.hasClass("tabs-container");
//        };

        function changeTab(sourceIndex,index) {
            var beforeTab = $('#tt').tabs('getTab',sourceIndex);
            setTitle($('#tt'), {'which':0,'title':'newnewnew'});
//            todo 通过改 title 来实现改图标的功能。
//            beforeTab.panel('setTitle', '123');
//            $('#first').title = '21231';
            debugger;
            var validate = beforeTab.form('validate');
            if (!validate && index !== sourceIndex) {
                $.messager.alert('提示消息', '在当前表单还有未填项，请填完后再切换', 'warning');
                // 通过下标去获取
                $('#tt').tabs("select", sourceIndex);
                return;
            } else {
                tabIndex = index;
//            $.ajax({
//                url: basePath + "/lendRequest/cacheFormDataByCardId",
//                type: "post",
//                data: beforeTab.form('getDataObj')
//            });
            }
        }
    });

</script>
<body>
<h2>Nested Tabs</h2>

<p>The tab panel can contain sub tabs or other components.</p>

<div style="margin:20px 0;"></div>
<div class="easyui-tabs" data-options="tools:'#tab-tools'" style="width:700px;height:250px">
    <div title="Sub Tabs" style="padding:10px;" id="main">
        <div class="easyui-tabs" data-options="fit:true,plain:true" id="tt">
            <div title="Title1" style="padding:10px;" id="first">
                <form id="ff1" method="post">
                    <div>
                        <select id="coo" class="easyui-combobox" name="dept" style="width:200px;">
                            <option value="aa" >aitem1</option>
                            <option value="bb"selected>bitem2</option>
                            <option value="cc">bitem3</option>
                            <option value="dd">ditem4</option>
                            <option value="ee">eitem5</option>
                        </select>
                    </div>
                    <div>
                        <label for="email">Email:</label>
                        <input class="easyui-validatebox" type="text" name="email" required="true" validType="email">
                    </div>
                    <div>
                        <label for="subject">Subject:</label>
                        <input class="easyui-validatebox" type="text" name="subject" required="true">
                    </div>
                    <div>
                        <label for="message">Message:</label>
                        &lt;textarea name="message" style="height:60px;"&gt;&lt;/textarea&gt;
                    </div>
                </form>
            </div>
            <div title="Title2" style="padding:10px;" id="second">
                <form id="ff2" method="post">
                    <div>
                        <label for="name">Name:</label>
                        <input class="easyui-validatebox" type="text" name="name" required="true">
                    </div>
                    <div>
                        <label for="email">Email:</label>
                        <input class="easyui-validatebox" type="text" name="email" required="true" validType="email">
                    </div>
                    <div>
                        <label for="subject">Subject:</label>
                        <input class="easyui-validatebox" type="text" name="subject" required="true">
                    </div>
                    <div>
                        <label for="message">Message:</label>
                        &lt;textarea name="message" style="height:60px;"&gt;&lt;/textarea&gt;
                    </div>
                </form>
            </div>
            <div title="Title3" style="padding:10px;" id="third">
                <form id="ff3" method="post">
                    <div>
                        <label for="name">Name:</label>
                        <input class="easyui-validatebox" type="text" name="name" required="true">
                    </div>
                    <div>
                        <label for="email">Email:</label>
                        <input class="easyui-validatebox" type="text" name="email" required="true" validType="email">
                    </div>
                    <div>
                        <label for="subject">Subject:</label>
                        <input class="easyui-validatebox" type="text" name="subject" required="true">
                    </div>
                    <div>
                        <label for="message">Message:</label>
                        &lt;textarea name="message" style="height:60px;"&gt;&lt;/textarea&gt;
                    </div>
                </form>
            </div>
            <div title="Title4" style="padding:10px;" id="forth">
                <form id="ff4" method="post">
                    <div>
                        <label for="name">Name:</label>
                        <input class="easyui-validatebox" type="text" name="name" required="true">
                    </div>
                    <div>
                        <label for="email">Email:</label>
                        <input class="easyui-validatebox" type="text" name="email" required="true" validType="email">
                    </div>
                    <div>
                        <label for="subject">Subject:</label>
                        <input class="easyui-validatebox" type="text" name="subject" required="true">
                    </div>
                    <div>
                        <label for="message">Message:</label>
                        &lt;textarea name="message" style="height:60px;"&gt;&lt;/textarea&gt;
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

</body>
</html>